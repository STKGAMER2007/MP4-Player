<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEO-SYSTEM // V4_EVOLVE</title>
    <style>

        :root {
            --neon: #00f2ff;
            --accent: #ff007b;
            --bg: #050505;
        }

        body {
            margin: 0; background: var(--bg); color: white;
            font-family: 'Orbitron', sans-serif; height: 100vh;
            display: grid; grid-template-columns: 300px 1fr; overflow: hidden;
        }

        /* --- LEFT PANEL: UPLOAD & DATABASE --- */
        .system-panel {
            background: rgba(10,10,10,0.8); border-right: 2px solid var(--neon);
            padding: 20px; display: flex; flex-direction: column; gap: 20px;
            backdrop-filter: blur(10px); z-index: 10;
        }

        .upload-zone {
            border: 2px dashed var(--neon); padding: 20px; text-align: center;
            font-size: 10px; color: var(--neon); cursor: pointer; transition: 0.3s;
        }
        .upload-zone:hover { background: rgba(0, 242, 255, 0.1); }

        .db-list { flex: 1; overflow-y: auto; font-family: 'JetBrains Mono'; font-size: 11px; }
        .db-item { 
            padding: 10px; border-bottom: 1px solid rgba(0,242,255,0.1); 
            cursor: pointer; transition: 0.2s;
        }
        .db-item:hover { color: var(--neon); background: rgba(0,242,255,0.05); }
        .db-item.active { border-left: 4px solid var(--neon); background: rgba(0,242,255,0.1); }

        /* --- MAIN CORE DESIGN --- */
        .main-stage {
            position: relative; display: flex; justify-content: center; align-items: center;
            background: radial-gradient(circle, #111 0%, #000 100%);
        }

        #targeting-reticle {
            position: absolute; width: 400px; height: 400px;
            border: 1px solid rgba(0, 242, 255, 0.2); border-radius: 50%;
            pointer-events: none; transition: 0.1s linear;
        }

        .core-hex {
            width: 220px; height: 220px;
            background: rgba(0,0,0,0.9); border: 2px solid var(--neon);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 5; box-shadow: 0 0 50px var(--neon);
        }

        /* --- BOTTOM CONTROLS --- */
        .control-dock {
            position: absolute; bottom: 30px; width: 600px;
            display: flex; align-items: center; gap: 20px;
            padding: 15px 30px; background: rgba(0,0,0,0.8);
            border: 1px solid var(--neon); clip-path: polygon(5% 0, 95% 0, 100% 50%, 95% 100%, 5% 100%, 0 50%);
        }

        .btn-v4 { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: white; }
        .btn-v4:hover { transform: scale(1.2); filter: drop-shadow(0 0 5px var(--neon)); }

        .progress-rail { flex: 1; height: 2px; background: #222; position: relative; cursor: pointer; }
        .progress-fill { height: 100%; width: 0%; background: var(--neon); box-shadow: 0 0 10px var(--neon); }

        canvas#viz { position: absolute; width: 100%; height: 100%; pointer-events: none; }
    </style>
</head>
<body>

    <div class="system-panel">
        <h2 style="font-size: 12px; letter-spacing: 3px; color: var(--accent);">[SYSTEM_ARCHITECT]</h2>
        
        <div class="upload-zone" onclick="document.getElementById('file-input').click()">
            üì• DROP_NEW_PACKET<br>OR CLICK TO INGEST
            <input type="file" id="file-input" hidden accept="audio/*">
        </div>

        <div class="db-list" id="db-list">
            </div>
        
        <div style="font-size: 9px; opacity: 0.5;">LOG: <span id="sys-log">IDLE</span></div>
    </div>

    <div class="main-stage">
        <canvas id="viz"></canvas>
        <div id="targeting-reticle"></div>
        
        <div class="core-hex">
            <div id="emoji-display" style="font-size: 4rem;">üß¨</div>
            <div id="track-id" style="font-size: 10px; margin-top: 10px; color: var(--neon);">ID_NULL</div>
        </div>

        <div class="control-dock">
            <button class="btn-v4" onclick="prev()">‚èÆÔ∏è</button>
            <button class="btn-v4" id="play-trigger" onclick="toggle()">‚ñ∂Ô∏è</button>
            <button class="btn-v4" onclick="next()">‚è≠Ô∏è</button>
            
            <div class="progress-rail" id="scrubber">
                <div class="progress-fill" id="bar"></div>
            </div>

            <div style="font-size: 10px; min-width: 50px;" id="time">0:00</div>
        </div>
    </div>

    <script>
        // Start with your current list
        let playlist = [
            { title: "Strangers", artist: "Kenya Grace", file: "Kenya Grace - Strangers (Official Lyric Video)(MP3_160K).mp3", genre: "üåå" },
            { title: "Sweater Weather", artist: "The Neighbourhood", file: "Sweater Weather(MP3_160K).mp3", genre: "üß•" },
            { title: "A COLD PLAY", artist: "The Kid LAROI", file: "The Kid LAROI - A COLD PLAY (Official Audio)(MP3_160K).mp3", genre: "‚ùÑÔ∏è" }
        ];

        let index = 0, isPlaying = false, audio = new Audio();
        let aCtx, analyser, source;

        // --- THE "AUTO-EVOLVE" INGESTION ENGINE ---
        document.getElementById('file-input').onchange = function(e) {
            const file = e.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                const newSong = {
                    title: file.name.replace(/\.[^/.]+$/, "").substring(0, 15),
                    artist: "UNKNOWN_HOST",
                    file: url,
                    genre: "‚ö°"
                };
                playlist.push(newSong);
                document.getElementById('sys-log').innerText = `PACKET_${playlist.length}_INGESTED`;
                renderDB();
            }
        };

        function renderDB() {
            const list = document.getElementById('db-list');
            list.innerHTML = '';
            playlist.forEach((s, i) => {
                const item = document.createElement('div');
                item.className = `db-item ${i === index ? 'active' : ''}`;
                item.innerHTML = `> [${i < 10 ? '0'+i : i}] ${s.title}`;
                item.onclick = () => load(i);
                list.appendChild(item);
            });
        }

        function load(idx) {
            index = idx;
            const s = playlist[index];
            audio.src = s.file;
            document.getElementById('emoji-display').innerText = s.genre;
            document.getElementById('track-id').innerText = `CORE_ID_${index}`;
            renderDB();
            if(isPlaying) audio.play();
        }

        // --- THE "TARGETING" MOUSE LOGIC ---
        document.addEventListener('mousemove', (e) => {
            const reticle = document.getElementById('targeting-reticle');
            const x = (e.clientX - window.innerWidth / 2) * 0.05;
            const y = (e.clientY - window.innerHeight / 2) * 0.05;
            reticle.style.transform = `translate(${x}px, ${y}px)`;
        });

        // --- AUDIO ENGINE ---
        function toggle() {
            if(!aCtx) initAudio();
            if(isPlaying) audio.pause(); else audio.play();
            isPlaying = !isPlaying;
            document.getElementById('play-trigger').innerText = isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
        }

        function initAudio() {
            aCtx = new AudioContext();
            analyser = aCtx.createAnalyser();
            source = aCtx.createMediaElementSource(audio);
            source.connect(analyser); analyser.connect(aCtx.destination);
            analyser.fftSize = 256;
            draw();
        }

        function draw() {
            const canvas = document.getElementById('viz');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const data = new Uint8Array(analyser.frequencyBinCount);

            function frame() {
                requestAnimationFrame(frame);
                analyser.getByteFrequencyData(data);
                ctx.clearRect(0,0,canvas.width,canvas.height);
                
                // Vertical Laser Visualizer
                data.forEach((v, i) => {
                    if (i % 4 === 0) {
                        const h = v * 1.5;
                        ctx.fillStyle = `rgba(0, 242, 255, ${v/255})`;
                        ctx.fillRect(i * 12, canvas.height - h, 2, h);
                    }
                });
            }
            frame();
        }

        audio.ontimeupdate = () => {
            document.getElementById('bar').style.width = (audio.currentTime/audio.duration)*100 + "%";
            document.getElementById('time').innerText = Math.floor(audio.currentTime/60) + ":" + Math.floor(audio.currentTime%60).toString().padStart(2,'0');
        };

        function next() { load((index + 1) % playlist.length); }
        function prev() { load((index - 1 + playlist.length) % playlist.length); }

        renderDB();
        load(0);
    </script>
</body>
</html>